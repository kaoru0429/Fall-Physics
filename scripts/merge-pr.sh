#!/bin/bash

# æª¢æŸ¥æ˜¯å¦æœ‰æœªæäº¤çš„æ›´æ”¹
if [[ -n $(git status -s) ]]; then
  echo "âŒ å·¥ä½œç›®éŒ„ä¸ä¹¾æ·¨ï¼Œè«‹å…ˆæäº¤æˆ– stash æ‚¨çš„æ›´æ”¹ã€‚"
  exit 1
fi

# ç²å–ç•¶å‰åˆ†æ”¯åç¨±
current_branch=$(git symbolic-ref --short HEAD)

# ç¢ºä¿åœ¨æ­£ç¢ºçš„åˆ†æ”¯ä¸Šï¼ˆä¾‹å¦‚ feat/auto-merge-systemï¼‰
# å¦‚æœéœ€è¦ï¼Œå¯ä»¥ä¿®æ”¹æ­¤è™•çš„é‚è¼¯ä»¥é©æ‡‰ä¸åŒçš„å·¥ä½œæµ
echo "ğŸ”€ æ­£åœ¨æº–å‚™åˆä½µ $current_branch..."

# ä½¿ç”¨ gh åˆä½µ PR
# --auto å•Ÿç”¨è‡ªå‹•åˆä½µï¼ˆå¦‚æœå•Ÿç”¨äº†åˆ†æ”¯ä¿è­·ï¼‰
# --merge ä½¿ç”¨åˆä½µæäº¤
# --delete-branch åˆä½µå¾Œåˆªé™¤åˆ†æ”¯
echo "ğŸ”„ æ­£åœ¨è‡ªå‹•åˆä½µ PR..."
gh pr merge --auto --merge --delete-branch

echo "âœ… PR åˆä½µè«‹æ±‚å·²ç™¼é€ï¼"
